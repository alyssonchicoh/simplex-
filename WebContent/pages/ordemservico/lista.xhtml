<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<ui:composition template="/index.xhtml">
		
		<ui:define name="nome_pagina">
			<h1>
				<STRONG>
					Consulta De Ordem de Serviços
				</STRONG>
		    </h1>
		</ui:define>
		
		<ui:define name="botoes">
			<div class="pull-right box-tools">
				<p:commandButton 
					class="btn btn-primary btn-md"
					value="#{msg['novo']}" 
					action="#{ordemServicoBean.showFormNovo}"
					immediate="true"/>
					
			</div>
		</ui:define>
		
		<ui:define name="corpo">
			<p:dialog 
				header="Status da Ordem de Serviço"
				id="filtroOrdemServico" 
				widgetVar="filtroOrdemServico"
				modal="true">
					
					<div class="box-body">
						<p:selectOneRadio id="console" value="#{ordemServicoBean.statusSelecionado}" unselectable="true">
            				<f:selectItem itemLabel="Em Andamento" itemValue="1" />
            				<f:selectItem itemLabel="Concluído" itemValue="2" />
            				<f:selectItem itemLabel="Cancelada" itemValue="3" />
            				<f:selectItem itemLabel="Aguardando" itemValue="4" />
            				<f:selectItem itemLabel="Pausada" itemValue="5" />
            			</p:selectOneRadio>
					</div>
					
					<div class="box-footer">
						<div class="pull-right box-tools">
							<p:commandButton 
								class="btn btn-danger btn-md" 
								value="Fechar"
								onclick="PF('filtroOrdemServico').hide();" />
						
							<p:commandButton 
								title="Selecionar" 
								class="btn btn-success btn-md"
								value="Salvar"
								immediate="false" 
								process="filtroOrdemServico"
								update="@form"
								action="#{ordemServicoBean.atualizarStatus}" />
						</div>
					</div>
			</p:dialog>
		
			<div class="box box-widget collapsed-box">
				<div class="box-header with-border">
					<div class="user-block">
						<ul class="sidebar-menu">
							<li class="active"><i class="fa fa-search"></i> <label><b>Filtros</b></label></li>
						</ul>
					</div>
				
					<div class="box-tools">
						<button type="button" class="btn btn-box-tool" data-widget="collapse">
							<i class="fa fa-plus"></i>
						</button>
					</div>
				</div>
				
				
				<div class="box-body">
					<div class="pull-right">
						<p:commandButton 
							update="@form"
							value="Limpar" 
							class="btn btn-danger btn-xs" 
							>
						</p:commandButton>
						
						<p:commandButton 
							class="btn btn-primary btn-xs"
							update="tbFuncaoFuncionario" 
							value="Filtrar" 
							 />
						<br />
					</div>
					
					<div class="row">
						<div class="col-md-6">
							<div class="form-group">
								<label><b>Código, Descrição ou CBO</b></label>
								<p:inputText 
									id="pesquisa" 
									maxlength="100" 
									styleClass="form-control"
									label="#{msg['descricao']}" 
									/>
							</div>
						</div>
					</div>
				</div>
			</div>
		
			<p:dataTable 
				id="tbFuncaoFuncionario"
				rows="10" 
				var="os" 
				paginator="true" 
				value="#{ordemServicoBean.osList}" 
				paginatorPosition="bottom" 
				paginatorAlwaysVisible="false" 
				emptyMessage="#{msg['lista.vazia']}">
					
					
			
			        <p:column width="60%" styleClass="align-center" headerText="Título">
			             #{os.titulo}
			        </p:column>
					
					<p:column width="10%" styleClass="align-center" headerText="Nº Chamado">
			             #{os.chamado.numero}
			        </p:column>
					
					<p:column width="20%" styleClass="align-center" headerText="Status">
			        	<ui:fragment rendered="#{os.status == 1}">
							<h4>
								<span class="label" style="background-color: #3C8DBC; color: #fff">
									Em Andamento
								</span>
							</h4>
						</ui:fragment>
			        	
			        	<ui:fragment rendered="#{os.status == 2}">
							<h4>
								<span class="label" style="background-color: #00A65A; color: #fff">
									Concluído
								</span>
							</h4>
						</ui:fragment>
			    
			        	<ui:fragment rendered="#{os.status == 3}">
							<h4>
								<span class="label" style="background-color: #D73925; color: #fff">
									Cancelada
								</span>
							</h4>
						</ui:fragment>
				
						
						<ui:fragment rendered="#{os.status == 4}">
							<h4>
								<span class="label" style="background-color: #BEBEBE; color: #000">
									AGUARDANDO
								</span>
							</h4>
						</ui:fragment>
						
								
						<ui:fragment rendered="#{os.status == 5}">
							<h4>
								<span class="label" style="background-color: #000; color: #fff">
									PAUSADA
								</span>
							</h4>
						</ui:fragment>
			        
			        </p:column>
					
					<p:column width="15%"  headerText="#{msg['acao']}" styleClass="align-center">
			        	<p:commandButton 
			        		icon="fa fa-exchange" 
			        		title="Alterar Status"  
			                class="btn btn-warning btn-xs" 
			                action="#{ordemServicoBean.selecionaOrdemServico(os)}"
			                oncomplete="PF('filtroOrdemServico').show();"
			               	update="filtroOrdemServico"
			               />
			             
			            <p:spacer width="10" />

			        	<p:commandButton 
			        		icon="ui-icon-pencil" 
			        		title="#{msg['editar']}"  
			                class="btn btn-primary btn-xs" 
			                immediate="true" />
			             
			            <p:spacer width="10" />
			              
			            <p:commandButton 
			            	icon="ui-icon-trash" 
			            	title="#{msg['excluir']}" 
			              	class="btn btn-danger btn-xs" 
			              	update="tbFuncaoFuncionario :messages" 
			              	immediate="true"
			              	oncomplete="setTimeout(function(){$('[id$=messages]').fadeOut()},'5000')">
			              	
			               		<p:confirm 
			               			header="Excluir Categoria Diaria" 
			               			message="Deseja excluir o registro em definitivo?" 
			               			icon="ui-icon-alert" />
			            </p:commandButton>
			                 
			           </p:column>
			
					   <f:facet name="footer">
							<h:outputText value="#{msg['lista.totalRegistros']} #{ordemServicoBean.osList.size()}" />
						</f:facet>
			
			</p:dataTable>
        </ui:define>
	</ui:composition>		
</html>