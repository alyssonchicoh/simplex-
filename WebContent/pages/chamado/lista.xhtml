<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/index.xhtml">


	<h:head>
		<title>Sistema de Chamados</title>
		<link rel="icon" type="image/x-icon"
			href="#{request.contextPath}/resources/img/logo-menor.png" />
	</h:head>

	<style type="text/css">
.old {
	background-color: #000 !important;
	background-image: none !important;
	color: #000000 !important;
}
</style>

	<script type="text/javascript">
		$(document).ready(function() {
			$('#dtChamados').DataTable();
			$('.dataTables_length').addClass('bs-select');
		});

		$(document).ready(function() {
			$('#dtBasicExample').DataTable();
			$('.dataTables_length').addClass('bs-select');
		});
	</script>

	<ui:define name="nome_pagina">
		<h1>
			<STRONG>Consulta de Chamados Solicitados Pelo Usuário <span
				style="color: #3C8DBC">#{chamadoBean.usuarioWeb.usuario.nome}</span></STRONG>
		</h1>
	</ui:define>

	<ui:define name="botoes">


		<div class="pull-right box-tools">
			<p:commandButton styleClass="btn-block btn-primary"
				value="#{msg['novo']}" action="#{categoriaBean.showFormNovo}" />
		</div>
	</ui:define>

	<ui:define name="corpo">
		<f:metadata>
			<f:viewAction action="#{chamadoBean.initAreaUsuario()}" />
		</f:metadata>



		<p:dialog header="Filtro de Data de Abertura do Chamado" id="filtroDataAberturaDialog" widgetVar="filtroDataAberturaDialog" modal="true">
			<div class="box-body">
				<div class="d-flex justify-content-center">
					<div class="form-group">
						<div class="col-md-4">
							<label><b>Data Inicial</b></label>
							<p:calendar />
						</div>
						<div class="col-md-2" />
						
						<div class="col-md-4">
							<label><b>Data Final</b></label>
							<p:calendar />
						</div>
					</div>
				</div>
			</div>

			<div class="box-footer">
				<div class="pull-right box-tools">
					<p:commandButton class="btn btn-danger btn-md" value="Fechar" onclick="PF('filtroDataAberturaDialog').hide();" />
				</div>
			</div>
		</p:dialog>
		
		<p:dialog header="Filtro de Data de Encerramento" id="filtroDataEncerramentoDialog" widgetVar="filtroDataEncerramentoDialog" modal="true">
			<div class="box-body">
				<div class="d-flex justify-content-center">
					<div class="form-group">
						<div class="col-md-4">
							<label><b>Data Inicial</b></label>
							<p:calendar />
						</div>
						<div class="col-md-2" />
						
						<div class="col-md-4">
							<label><b>Data Final</b></label>
							<p:calendar />
						</div>
					</div>
				</div>
			</div>

			<div class="box-footer">
				<div class="pull-right box-tools">
					<p:commandButton class="btn btn-danger btn-md" value="Fechar" onclick="PF('filtroDataEncerramentoDialog').hide();" />
				</div>
			</div>
		</p:dialog>
		


		<ui:fragment>
			<div class="box box-widget collapsed-box">

				<div class="box-header with-border">
					<div class="user-block">
						<ul class="sidebar-menu">
							<li class="active"><i class="fa fa-search"></i> <label><b>#{msg['filtros']}</b></label></li>
						</ul>
					</div>

					<!-- /.user-block -->
					<div class="box-tools">
						<button type="button" class="btn btn-box-tool"
							data-widget="collapse">
							<i class="fa fa-plus"></i>
						</button>

					</div>

					<!-- /.box-tools -->
				</div>

				<!-- /.box-header -->
				<div class="box-body">
					<div class="pull-right">

						<p:commandButton update="@form" value="#{msg['limpar']}"
							class="btn btn-danger btn-xs" action="#{permissaoBean.listar}">
							<f:setPropertyActionListener target="#{permissaoBean.pesquisa}"
								value="" />
						</p:commandButton>


						<p:commandButton class="btn btn-primary btn-xs"
							value="#{msg['filtrar']}" action="#{filtroChamadoBean.consultar}" update="tbChamados"/>
						<br />
					</div>

					<div class="row">

						<!-- DIV DA Coluna -->
						<div class="col-md-6">
							<!-- DIV DO ELEMTNO -->
							<div class="form-group">
								<label><b>Filtros Selecionados</b></label>

							</div>
						</div>

					</div>


					<div class="row">
						<div class="col-md-12">

							<p:tabView>
								<p:tab title="Filtros de Características">
									<div class="row">

										<div class="col-md-6">
											<div class="form-group">

												<!-- DIV DO ELEMTNO -->
												<label><b>Título</b></label>
												<p:inputText maxlength="100" styleClass="form-control"
													label="#{msg['descricao']}"
													value="#{filtroChamadoBean.tituloFiltro}" />
											</div>
										</div>

										<div class="col-md-6">
											<div class="form-group">

												<!-- DIV DO ELEMTNO -->
												<label><b>Descrição</b></label>
												<p:inputText maxlength="100" styleClass="form-control"
													label="#{msg['descricao']}"
													value="#{permissaoBean.pesquisa}" />
											</div>
										</div>
									</div>
									<div class="row">

										<div class="col-md-3">
											<div class="form-group">
												<label><b>Prioridade</b></label>

												<div class="input-group input-group-sm">
													<h:inputHidden label="#{msg['municipio.destino']}"
														id="campoPrioridadeHidden" required="false"
														converter="genericCvt" />
													<p:inputText maxlength="45" styleClass="form-control"
														label="#{msg['municipio.destino']}" id="campoPrioridade"
														readonly="true"
														value="#{chamadoBean.chamado.categoria.nome}" />

													<span class="input-group-btn"> <p:commandButton
															id="botaoSelecaoPrioridade" icon="ui-icon-search"
															class="btn-primary btn-xs" onclick="PF('dlg1').show();"
															immediate="true">


														</p:commandButton>
													</span>
												</div>
											</div>
										</div>

										<div class="col-md-3">
											<div class="form-group">
												<label><b>Categoria</b></label>

												<div class="input-group input-group-sm">
													<h:inputHidden label="#{msg['municipio.destino']}"
														id="campoCategoriaHidden" required="false"
														converter="genericCvt" />
													<p:inputText maxlength="45" styleClass="form-control"
														label="#{msg['municipio.destino']}" id="campoCategoria"
														readonly="true"
														value="#{chamadoBean.chamado.categoria.nome}" />

													<span class="input-group-btn"> <p:commandButton
															id="botaoSelecaoCategoria" icon="ui-icon-search"
															class="btn-primary btn-xs" onclick="PF('dlg1').show();"
															immediate="true">


														</p:commandButton>
													</span>
												</div>
											</div>
										</div>
										<div class="col-md-2">
											<div class="form-group">
												<label><b>Já Informado</b></label>

												<p:selectOneRadio 
													unselectable="true">
													<f:selectItem itemLabel="Sim" itemValue="Sim" />
													<f:selectItem itemLabel="Não" itemValue="Não" />

												</p:selectOneRadio>
											</div>
										</div>
										<div class="col-md-2">
											<div class="form-group">
												<label><b>Recorrente</b></label>

												<p:selectOneRadio
													unselectable="true">
													<f:selectItem itemLabel="Sim" itemValue="Sim" />
													<f:selectItem itemLabel="Não" itemValue="Não" />

												</p:selectOneRadio>
											</div>
										</div>

										<div class="col-md-2">
											<div class="form-group">
												<label><b>Trabalhos Parados</b></label>

												<p:selectOneRadio 
													unselectable="true">
													<f:selectItem itemLabel="Sim" itemValue="Sim" />
													<f:selectItem itemLabel="Não" itemValue="Não" />

												</p:selectOneRadio>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-md-3">
											<div class="form-group">
												<label><b>Data de Abertura</b></label>

												<div class="input-group input-group-sm">
													<h:inputHidden label="#{msg['municipio.destino']}"
														required="false" converter="genericCvt" />
													<p:inputText maxlength="45" styleClass="form-control"
														label="#{msg['municipio.destino']}" readonly="true"
														value="#{chamadoBean.chamado.categoria.nome}" />

													<span class="input-group-btn"> <p:commandButton
															icon="ui-icon-calendar" class="btn-primary btn-xs"
															onclick="PF('filtroDataAberturaDialog').show();"
															immediate="true">


														</p:commandButton>
													</span>
												</div>
											</div>
										</div>


										<div class="col-md-3">
											<div class="form-group">
												<label><b>Data de Encerramento</b></label>

												<div class="input-group input-group-sm">
													<h:inputHidden label="#{msg['municipio.destino']}"
														required="false" converter="genericCvt" />
													<p:inputText maxlength="45" styleClass="form-control"
														label="#{msg['municipio.destino']}" readonly="true"
														value="#{chamadoBean.chamado.categoria.nome}" />

													<span class="input-group-btn"> <p:commandButton
															icon="ui-icon-calendar" class="btn-primary btn-xs"
															onclick="PF('filtroDataEncerramentoDialog').show();" immediate="true">


														</p:commandButton>
													</span>
												</div>
											</div>
										</div>


										<div class="col-md-3">
											<div class="form-group">
												<label><b>Data da Última Atualização</b></label>

												<div class="input-group input-group-sm">
													<h:inputHidden label="#{msg['municipio.destino']}"
														required="false" converter="genericCvt" />
													<p:inputText maxlength="45" styleClass="form-control"
														label="#{msg['municipio.destino']}" readonly="true"
														value="#{chamadoBean.chamado.categoria.nome}" />

													<span class="input-group-btn"> <p:commandButton
															icon="ui-icon-calendar" class="btn-primary btn-xs"
															onclick="PF('dlg1').show();" immediate="true">


														</p:commandButton>
													</span>
												</div>
											</div>
										</div>


										<div class="col-md-3">
											<div class="form-group">
												<label><b>Data da Solução</b></label>

												<div class="input-group input-group-sm">
													<h:inputHidden label="#{msg['municipio.destino']}"
														required="false" converter="genericCvt" />
													<p:inputText maxlength="45" styleClass="form-control"
														label="#{msg['municipio.destino']}" readonly="true"
														value="#{chamadoBean.chamado.categoria.nome}" />

													<span class="input-group-btn"> <p:commandButton
															icon="ui-icon-calendar" class="btn-primary btn-xs"
															onclick="PF('dlg1').show();" immediate="true">


														</p:commandButton>
													</span>
												</div>
											</div>
										</div>



									</div>


								</p:tab>
								<p:tab title="Filtros de Requerente">

								</p:tab>
								<p:tab title="Filtros de Observador">

								</p:tab>

								<p:tab title="Filtros de Atribuição">

								</p:tab>

								<p:tab title="Filtros de Estatisticas">

								</p:tab>
								
								<p:tab title="Exibição dos Campos">
								
								<ui:repeat var="campo" value="#{filtroChamadoBean.exibicaoCampos}" >
									<f:attribute name="nomeCampo" value="#{campo.nome}" />
								
								 <p:selectBooleanCheckbox value="#{filtroChamadoBean.verificaCampoMarcado(campo)}" itemLabel="#{campo.nome}" >
								             <p:ajax update="tbChamados" listener="#{filtroChamadoBean.atualizaCampo(campo.nome)}" />
								 
        						</p:selectBooleanCheckbox>
								</ui:repeat>

								</p:tab>
							</p:tabView>
						</div>
					</div>

				</div>
			</div>


			<p:dataTable id="tbChamados" rows="9" var="cha" paginator="true"
				value="#{filtroChamadoBean.chamadoList}" paginatorPosition="bottom"
				paginatorAlwaysVisible="false" emptyMessage="#{msg['lista.vazia']}">

				<p:column headerText="Número" styleClass="align-center" width="10%" rendered="#{filtroChamadoBean.verificaExibicaoCampo(filtroChamadoBean.NUMERO_CHAMADO)}">
				#{cha.numero}
				</p:column>

				<p:column headerText="Status" styleClass="align-center" width="20%" rendered="#{filtroChamadoBean.verificaExibicaoCampo(filtroChamadoBean.STATUS_CHAMADO)}">
					<ui:fragment rendered="#{cha.status == 1}">
						<h4>
							<span class="label"
								style="background-color: #BCD2EE; color: #000">Aguardando
								Alocação de Técnico</span>
						</h4>
					</ui:fragment>

					<ui:fragment rendered="#{cha.status == 2}">
						<h4>
							<span class="label"
								style="background-color: #FFD700; color: #000">Na Fila de
								Atendimento</span>
						</h4>
					</ui:fragment>

					<ui:fragment rendered="#{cha.status == 3}">
						<h4>
							<span class="label"
								style="background-color: #4682B4; color: #fff">Em
								Atendimento</span>
						</h4>
					</ui:fragment>

					<ui:fragment rendered="#{cha.status == 4}">
						<h4>
							<span class="label"
								style="background-color: #20B2AA; color: #fff">Solucionado</span>
						</h4>
					</ui:fragment>

					<ui:fragment rendered="#{cha.status == 5}">
						<h4>
							<span class="label"
								style="background-color: #228B22; color: #fff">Finalizado</span>
						</h4>
					</ui:fragment>

					<ui:fragment rendered="#{cha.status == 6}">
						<h4>
							<span class="label"
								style="background-color: #A52A2A; color: #fff">Impedido</span>
						</h4>
					</ui:fragment>

					<ui:fragment rendered="#{cha.status == 7}">
						<h4>
							<span class="label"
								style="background-color: #CD8162; color: #fff">Aguardando
								Viabilidade</span>
						</h4>
					</ui:fragment>

					<ui:fragment rendered="#{cha.status == 8}">
						<h4>
							<span class="label" style="background-color: #000; color: #fff">Rejeitado</span>
						</h4>
					</ui:fragment>

					<ui:fragment rendered="#{cha.status == 9}">
						<h4>
							<span class="label"
								style="background-color: #CFCFCF; color: #000">Aguardando
								Feedback Usuário</span>
						</h4>
					</ui:fragment>
				</p:column>


				<p:column headerText="Data Abertura" styleClass="align-center"
					width="10%" rendered="#{filtroChamadoBean.verificaExibicaoCampo(filtroChamadoBean.DATA_ABERTURA_CHAMADO)}">
					<h:outputText value="#{cha.dataAbertura}">
						<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
					</h:outputText>


				</p:column>


				<p:column headerText="Título" styleClass="align-center" rendered="#{filtroChamadoBean.verificaExibicaoCampo(filtroChamadoBean.TITULO_CHAMADO)}">
						#{cha.titulo}
					</p:column>



				<p:column width="5%" styleClass="align-center"
					headerText="#{msg['acao']}">

					<p:commandButton icon="ui-icon-search"
						class="btn btn-warning btn-xs"
						action="#{chamadoBean.visualizarDetalhado(cha.id)}"
						id="visualizarChamado" />
					<p:tooltip id="visualizarChamadoTooltip" for="visualizarChamado"
						value="Visualizar Detalhamento do Chamado" position="top" />

				</p:column>


				<f:facet name="footer">
					<h:outputText
						value="#{msg['lista.totalRegistros']} #{chamadoBean.chamadoList.size()}" />
				</f:facet>
			</p:dataTable>
		</ui:fragment>
	</ui:define>
</ui:composition>

</html>